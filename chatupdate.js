function rr(){if(typeof XMLHttpRequest==='undefined'){XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0");}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0");}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP");}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP");}catch(e){}return null;}}return new XMLHttpRequest();}function ee(e){if(e.message!==undefined&&e.message!==null){alert(e.message);}else{alert(e);}}var r=null,o="0",t=0,c=0,b=0;function n(){return document.hidden===true}function bs(){var u=+updint;return n()?Math.max(u,5000)*(1+Math.min(b,5)):u}function h(){if(r.readyState==4&&c<90){try{var e=r.responseText;if(e!=null&&e.length>1){var f=e.indexOf("||");if(f!=-1){if(longpoll)o=e.substring(0,f);else msg=e.substring(0,f);e=e.substring(f+2);if(e.length>0){var msgs=document.getElementById("msgs");var d=document.createElement("div");d.innerHTML=e;for(var i=d.childNodes.length-1;i>=0;i--){e=d.childNodes[i];try{if(e instanceof HTMLBRElement)continue;}catch(x){}if(reverse){msgs.appendChild(e);}else{msgs.insertBefore(e,msgs.firstChild);}}while(msgs.childNodes.length>msglimit){msgs.removeChild(reverse?msgs.firstChild:msgs.lastChild);}}}if(autoscroll&&reverse)setTimeout("autoScroll(false,false)",500);b=0;}}catch(e){ee(e);b++;}t=setTimeout("a();",bs());}}function a(){if(n()){t=setTimeout("a()",bs());return}if(!(++c>70))try{if(null==(r=rr()))return;r.onreadystatechange=h;r.open("GET",url+"&m="+msg+"&o="+o);r.send(null);}catch(e){ee(e);b++;t=setTimeout("a()",bs())}}try{t=setTimeout("a()",bs())}catch(e){ee(e)}try{document.addEventListener("visibilitychange",function(){try{if(n()){c=99;if(t!=0)clearTimeout(t);if(r!=null)r.abort();}else{c=0;t=setTimeout("a()",100);}}catch(e){}});window.onbeforeunload=function(){c=99;try{if(t!=0)clearTimeout(t);if(r!=null)r.abort();}catch(e){}}}catch(e){}